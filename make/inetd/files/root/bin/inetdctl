#!/bin/sh

usage()
{
  echo "usage: inetdctl [pending|enable [ftpd|smbd]|disable [ftpd|smbd]]"
  exit 1
}

# This script only controls AVM's ftpd and smbd but not Freetz samba/smbd.
if [ "$1" == "pending" ]; then
	for daemon in /tmp/.inetd.pending.*; do
		[ -e "$daemon" ] && inetdctl enable ${daemon##*.}
	done
	exit
fi
[ "$1" != "enable" -a "$1" != "disable" ] && usage
[ "$2" != "ftpd" -a "$2" != "smbd" ] && usage

rm -f /tmp/.inetd.pending.$2
if [ -d /mod/etc/default.$2 ]; then
	/mod/etc/init.d/rc.$2 inetd_$1
else
	[ "$1" == "enable" ] && touch /tmp/.inetd.pending.$2
fi

